{"version":3,"sources":["webpack:///./src/app/pages/edit-category/edit-category.module.ts","webpack:///./src/app/pages/edit-category/edit-category.page.html","webpack:///./src/app/pages/edit-category/edit-category.page.scss","webpack:///./src/app/pages/edit-category/edit-category.page.ts"],"names":[],"mappings":"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","file":"pages-edit-category-edit-category-module.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { EditCategoryPage } from './edit-category.page';\nimport {EditCategoryNamePage} from '../edit-category-name/edit-category-name.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: EditCategoryPage\n  }\n];\n\n@NgModule({\n    imports: [\n        CommonModule,\n        FormsModule,\n        IonicModule,\n        RouterModule.forChild(routes)\n    ],\n    declarations: [\n        EditCategoryPage,\n        EditCategoryNamePage\n    ],\n    entryComponents: [\n        EditCategoryNamePage\n    ]\n})\nexport class EditCategoryPageModule {}\n","module.exports = \"<ion-header>\\n  <ion-toolbar color=\\\"primary\\\">\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-button color=\\\"light\\\" (click)=\\\"back()\\\">\\n        <ion-icon slot=\\\"icon-only\\\" name=\\\"arrow-back\\\"></ion-icon>返回\\n      </ion-button>\\n    </ion-buttons>\\n    <ion-title>编辑分类</ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content no-padding>\\n  <ion-list margin-top>\\n    <ion-list-header>\\n      <ion-label>大分类</ion-label>\\n    </ion-list-header>\\n    <ion-item-sliding #itemSliding>\\n      <ion-item>\\n        <ion-label>{{category.name}}</ion-label>\\n      </ion-item>\\n      <ion-item-options side=\\\"end\\\">\\n        <ion-item-option color=\\\"primary\\\" (click)=\\\"onEditCategoryName(itemSliding)\\\">\\n          <ion-icon name=\\\"create\\\"></ion-icon>编辑\\n        </ion-item-option>\\n        <ion-item-option color=\\\"danger\\\" (click)=\\\"onDelete(itemSliding, category.id)\\\">\\n          <ion-icon name=\\\"trash\\\"></ion-icon>删除\\n        </ion-item-option>\\n      </ion-item-options>\\n    </ion-item-sliding>\\n    <ion-list-header>\\n      <ion-label>小分类</ion-label>\\n    </ion-list-header>\\n    <ion-item-sliding *ngFor=\\\"let child of category.children\\\" #item>\\n      <ion-item>\\n        <ion-label>{{child.name}}</ion-label>\\n      </ion-item>\\n      <ion-item-options side=\\\"end\\\">\\n        <ion-item-option color=\\\"primary\\\" (click)=\\\"onEditSubCategoryName(item, child)\\\">\\n          <ion-icon name=\\\"create\\\"></ion-icon>编辑\\n        </ion-item-option>\\n        <ion-item-option color=\\\"danger\\\" (click)=\\\"onDelete(item, child.id)\\\">\\n          <ion-icon name=\\\"trash\\\"></ion-icon>删除\\n        </ion-item-option>\\n      </ion-item-options>\\n    </ion-item-sliding>\\n  </ion-list>\\n</ion-content>\\n\"","module.exports = \"\"","import {Component, NgZone, OnInit, ViewChild} from '@angular/core';\nimport {ActivatedRoute, Router} from '@angular/router';\nimport {Category} from '../../shared/category';\nimport {CategoryService} from '../../services/category.service';\nimport {AlertController, ItemSliding, ModalController} from '@ionic/angular';\nimport {EditCategoryNamePage} from '../edit-category-name/edit-category-name.page';\nimport {Location} from '@angular/common';\n\n@Component({\n  selector: 'app-edit-category',\n  templateUrl: './edit-category.page.html',\n  styleUrls: ['./edit-category.page.scss'],\n})\nexport class EditCategoryPage implements OnInit {\n  category: Category;\n  id: number;\n  constructor(private activatedRoute: ActivatedRoute, private categoryService: CategoryService,\n              private modalController: ModalController, private alertController: AlertController,\n              private router: Router, private location: Location, private ngZone: NgZone) {\n      activatedRoute.queryParams.subscribe(queryParams => {\n          this.id = queryParams.id;\n      });\n      this.categoryService.get(this.id).then( (data) => {\n        if (data.success) {\n          this.category = data.result;\n        }\n      });\n  }\n  ionViewWillEnter() {\n      this.categoryService.get(this.id).then( (data) => {\n          if (data.success) {\n              this.category = data.result;\n          }\n      });\n  }\n  ngOnInit() {\n  }\n  private async presentModal(name: string) {\n    const modal = await this.modalController.create({\n        component: EditCategoryNamePage,\n        componentProps: { value: name }\n    });\n    await modal.present();\n    return modal.onWillDismiss();\n  }\n  async onEditCategoryName(item: ItemSliding) {\n      item.close();\n      const {data} = await this.presentModal(this.category.name);\n      if (data) {\n          this.category.name = data;\n          this.categoryService.update(this.category);\n      }\n  }\n  async onEditSubCategoryName(item: ItemSliding, subCategory: Category) {\n      item.close();\n      const {data} = await this.presentModal(subCategory.name);\n      if (data) {\n          let id = subCategory.id;\n          for (let c of this.category.children) {\n              if (c.id == id) {\n                  c.name = data;\n                  this.categoryService.update(this.category);\n                  break;\n              }\n          }\n      }\n  }\n  async onDelete(item: ItemSliding, subId: number) {\n    item.close();\n    let alert = await this.alertController.create({\n        header: '你确认要删除吗!',\n        message: '请先删除该类别下的所有商品记录',\n        buttons: [\n            {\n                text: '取消',\n                role: 'cancel',\n                cssClass: 'secondary',\n                handler: (blah) => {\n            }\n            }, {\n                text: '确认',\n                handler: () => {\n                if (this.categoryService.delete(subId)) {\n                    // 删除成功\n                    this.ngZone.run(() => {\n                        this.router.navigateByUrl('categoryList');\n                    });\n                }\n            }\n            }\n        ]\n    });\n    await alert.present();\n  }\n  back() {\n      this.location.back();\n  }\n}\n"],"sourceRoot":""}